---
import Navigation from './Navigation.astro';
---

<div class="md:hidden">
  <button id="mobile-menu-btn" class="inline-flex items-center justify-center rounded-md p-2 text-muted-foreground hover:bg-accent hover:text-accent-foreground focus:outline-none" aria-label="Menu">
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-6 w-6"><line x1="3" x2="21" y1="6" y2="6"/><line x1="3" x2="21" y1="12" y2="12"/><line x1="3" x2="21" y1="18" y2="18"/></svg>
  </button>
  
  <div id="mobile-menu-content" class="fixed inset-0 w-full transition-transform duration-300 ease-in-out -translate-x-full" style="z-index: 50; background-color: #ffffff;">
    <div class="flex items-center justify-between p-6 pb-4 border-b" style="background-color: inherit;">
        <a href="https://t.me/nanobananas_bot" target="_blank" rel="noopener noreferrer" class="font-bold text-lg hover:text-primary transition-colors">üçå @nanobananas_bot</a>
        <button id="mobile-menu-close" class="rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="h-5 w-5"><path d="M18 6 6 18"/><path d="m6 6 18 18"/></svg>
            <span class="sr-only">Close</span>
        </button>
    </div>
    <div class="overflow-y-auto px-6 pb-6" style="height: calc(100vh - 5rem); background-color: inherit;">
        <div class="mobile-nav-wrapper" style="background-color: #f5f5f5; padding: 1.5rem; border-radius: 1rem; margin-top: 1rem;">
          <Navigation />
        </div>
    </div>
  </div>
</div>

<script>
  function initMobileMenu() {
    const btn = document.getElementById('mobile-menu-btn');
    const closeBtn = document.getElementById('mobile-menu-close');
    const menu = document.getElementById('mobile-menu-content');
    
    if (!btn || !closeBtn || !menu) return;
    
    const navLinks = menu.querySelectorAll('a');

    function openMenu() {
      if (!menu) return;
      menu.classList.remove('-translate-x-full');
      document.body.style.overflow = 'hidden';
      
      // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ñ–æ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–µ–º—ã
      const theme = document.documentElement.getAttribute('data-theme');
      const bgColor = theme === 'dark' ? '#0a0a0a' : '#ffffff';
      const wrapperBgColor = theme === 'dark' ? '#1a1a1a' : '#f5f5f5';
      
      menu.style.backgroundColor = bgColor;
      const header = menu.querySelector('.border-b') as HTMLElement | null;
      const scrollArea = menu.querySelector('.overflow-y-auto') as HTMLElement | null;
      const wrapper = menu.querySelector('.mobile-nav-wrapper') as HTMLElement | null;
      
      if (header) header.style.backgroundColor = bgColor;
      if (scrollArea) scrollArea.style.backgroundColor = bgColor;
      if (wrapper) wrapper.style.backgroundColor = wrapperBgColor;
    }

    function closeMenu() {
      if (!menu) return;
      menu.classList.add('-translate-x-full');
      document.body.style.overflow = '';
    }

    btn.addEventListener('click', openMenu);
    closeBtn.addEventListener('click', closeMenu);

    // Close on link click
    navLinks.forEach(link => {
      link.addEventListener('click', closeMenu);
    });
  }
  
  // Initialize immediately if DOM is ready, otherwise wait
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initMobileMenu);
  } else {
    initMobileMenu();
  }
</script>

<style>
  /* –ú–æ–±–∏–ª—å–Ω–æ–µ –º–µ–Ω—é - –ü–û–õ–ù–û–°–¢–¨–Æ –ù–ï–ü–†–û–ó–†–ê–ß–ù–´–ô –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä */
  #mobile-menu-content {
    z-index: 50 !important;
    box-shadow: -4px 0 24px rgba(0, 0, 0, 0.15);
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }
  
  /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ - –ß–ï–†–ù–´–ô –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
  [data-theme="dark"] #mobile-menu-content {
    background: #0a0a0a !important;
    color: #fafafa !important;
  }
  
  /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ - –ë–ï–õ–´–ô –Ω–µ–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–π —Ñ–æ–Ω */
  [data-theme="light"] #mobile-menu-content {
    background: #ffffff !important;
    color: #0a0a0a !important;
  }
  
  /* –ì—Ä–∞–Ω–∏—Ü–∞ –≤ —Ç–µ–º–Ω–æ–π —Ç–µ–º–µ */
  [data-theme="dark"] #mobile-menu-content .border-b {
    border-color: #27272a;
    background: #0a0a0a !important;
  }
  
  /* –ì—Ä–∞–Ω–∏—Ü–∞ –≤ —Å–≤–µ—Ç–ª–æ–π —Ç–µ–º–µ */
  [data-theme="light"] #mobile-menu-content .border-b {
    border-color: #e5e7eb;
    background: #ffffff !important;
  }
  
  /* –û–±–ª–∞—Å—Ç—å –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ - –ù–ï–ü–†–û–ó–†–ê–ß–ù–´–ô —Ñ–æ–Ω */
  #mobile-menu-content .overflow-y-auto {
    background: inherit !important;
  }
  
  [data-theme="dark"] #mobile-menu-content .overflow-y-auto {
    background: #0a0a0a !important;
  }
  
  [data-theme="light"] #mobile-menu-content .overflow-y-auto {
    background: #ffffff !important;
  }
  
  /* –ö–í–ê–î–†–ê–¢ –° –§–û–ù–û–ú –ü–û–î –ù–ê–í–ò–ì–ê–¶–ò–ï–ô */
  .mobile-nav-wrapper {
    padding: 1.5rem;
    border-radius: 1rem;
    margin-top: 1rem;
  }
  
  /* –¢–µ–º–Ω–∞—è —Ç–µ–º–∞ - —Ç–µ–º–Ω—ã–π –∫–≤–∞–¥—Ä–∞—Ç */
  [data-theme="dark"] .mobile-nav-wrapper {
    background-color: #1a1a1a !important;
  }
  
  /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ - —Å–≤–µ—Ç–ª—ã–π –∫–≤–∞–¥—Ä–∞—Ç */
  [data-theme="light"] .mobile-nav-wrapper {
    background-color: #f5f5f5 !important;
  }
  
  /* –£–±–∏—Ä–∞–µ–º –≤—Å–µ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏ –∏–∑ –¥–æ—á–µ—Ä–Ω–∏—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤ */
  #mobile-menu-content * {
    backdrop-filter: none !important;
    -webkit-backdrop-filter: none !important;
  }
</style>
